name: '[T0000] Named Pipes'
integration: Splunk
reference: https://github.com/olafhartong/ThreatHunting
description: Hunting query based on sysmon or windows events for Splunk
author: olafhartong
mitre_technique:
  id: T0000
  datasources:
  - Named Pipes
coverage:
  sources:
    and:
    - XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
search: '`indextime` `sysmon` event_id=17 (pipe_name="*isapi_http*" OR pipe_name="*isapi_dg*"
  OR pipe_name="*isapi_dg2*" OR pipe_name="*isapi_http*" OR pipe_name="*sdlrpc*" OR
  pipe_name="*aheec*" OR pipe_name="*winsession*" OR pipe_name="*lsassw*" OR pipe_name="*rpchlp_3*"
  OR pipe_name="*NamePipe_MoreWindows*" OR pipe_name="*pcheap_reuse*" OR pipe_name="*PSEXESVC*"
  OR pipe_name="*PowerShellISEPipeName_*" OR pipe_name="*csexec*" OR pipe_name="*paexec*"
  OR pipe_name="*remcom*")  \

  | eval mitre_technique_id="T1077" \

  | `pipe_whitelist` \

  | eval indextime = _indextime \

  | convert ctime(indextime) \

  | table _time indextime event_description host_fqdn pipe_name process_path process_guid
  process_id'
