name: '[T1193] Spearphishing Attachment'
integration: Splunk
reference: https://github.com/olafhartong/ThreatHunting
description: Hunting query based on sysmon or windows events for Splunk
author: olafhartong
mitre_technique:
  id: T1193
  datasources:
  - File monitoring
coverage:
  sources:
    and:
    - XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
search: '`indextime` `sysmon` event_id=11 (file_name="*.docm" OR file_name="*.xlsm"
  OR file_name="*.pptm" OR file_name="*.ps1" OR file_name="*.py" OR file_name="*.js"
  OR file_name="*.vbs" OR file_name="*.hta" OR file_name="*.bat" OR file_name="*.slk"
  OR file_name="*.jspx" OR file_name="*.cmd" OR file_name="*.php" OR file_name="*.pyw"
  OR file_name="*.xla" OR file_name="*.application" OR file_name="*.potm" OR file_name="*.csproj"
  OR file_name="*.aspx" OR file_name="*.exe") \

  | eval mitre_technique_id="T1193" \

  | `file_create_whitelist`\

  | eval indextime = _indextime | convert ctime(indextime) | table _time indextime
  event_description host_fqdn process_path process_guid process_id file_name file_path'
