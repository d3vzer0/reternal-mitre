name: '[T0000] Suspicious filename used'
author: olafhartong
description: Hunting query based on sysmon or windows events for Splunk
reference: https://github.com/olafhartong/ThreatHunting
integration: Splunk
mitre_technique:
  id: T0000
queries:
- '`indextime` ((`sysmon` event_id=1) OR (`windows-security` event_id=4688)) (process_name=a.exe
  OR process_name=b.exe OR process_name=c.exe OR process_name=d.exe OR process_name=e.exe
  OR process_name=f.exe OR process_name=g.exe OR process_name=h.exe OR process_name=i.exe
  OR process_name=j.exe OR process_name=k.exe OR process_name=l.exe OR process_name=m.exe
  OR process_name=n.exe OR process_name=o.exe OR process_name=p.exe OR process_name=q.exe
  OR process_name=r.exe OR process_name=s.exe OR process_name=t.exe OR process_name=u.exe
  OR process_name=v.exe OR process_name=w.exe OR process_name=x.exe OR process_name=y.exe
  OR process_name=z.exe OR process_name=1.exe OR process_name=2.exe OR process_name=3.exe
  OR process_name=4.exe OR process_name=5.exe OR process_name=6.exe OR process_name=7.exe
  OR process_name=8.exe OR process_name=9.exe OR process_name=0.exe OR process_name=10.exe)
  \

  | eval mitre_technique_id="T0000" \

  | eval hash_sha256= lower(hash_sha256) \

  | `process_create_whitelist` \

  | eval indextime = _indextime \

  | convert ctime(indextime) \

  | table _time indextime event_description hash_sha256 host_fqdn user_name original_file_name
  process_path process_guid process_parent_path process_id process_parent_id process_command_line
  process_parent_command_line process_parent_guid file_description'
