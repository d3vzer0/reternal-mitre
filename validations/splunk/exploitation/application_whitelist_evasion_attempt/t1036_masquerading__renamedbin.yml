name: '[T1036] Masquerading - renamedbin'
integration: Splunk
reference: https://github.com/olafhartong/ThreatHunting
description: Hunting query based on sysmon or windows events for Splunk
author: olafhartong
mitre_technique:
  id: T1036
  datasources:
  - Process command-line parameters
  - Process monitoring
coverage:
  app:
    and: ThreatHunting
  sourcetype:
    and:
    - XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
search: '`indextime` `sysmon` event_id=1 | eval process_name=lower(process_name) |
  eval original_file_name=lower(original_file_name) | where process_name!=original_file_name  \
  | eval mitre_technique_id="T1036" \
  | eval hash_sha256= lower(hash_sha256)\
  | `process_create_whitelist`\
  | eval indextime = _indextime | convert ctime(indextime) | table _time indextime
  event_description hash_sha256 host_fqdn user_name original_file_name process_path
  process_guid process_parent_path process_id process_parent_id process_command_line
  process_parent_command_line process_parent_guid'
